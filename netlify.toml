[build]
publish = "."
functions = "netlify/functions"
command = """
set -e
mkdir -p vendor
echo 'Downloading Auth0 SPA SDK locallyâ€¦'
curl -fsSL https://unpkg.com/@auth0/auth0-spa-js@2.1.3/dist/auth0-spa-js.production.js \
  -o vendor/auth0-spa-js.production.js
curl -fsSL https://unpkg.com/@auth0/auth0-spa-js@2.1.3/dist/auth0-spa-js.production.esm.js \
  -o vendor/auth0-spa-js.production.esm.js
"""

# Serve the real file for /callback (avoid SPA swallowing it)
[[redirects]]
  from = "/callback"
  to = "/callback.html"
  status = 200

# Keep SPA fallback LAST
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200